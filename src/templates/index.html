<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Frame Manager</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { margin-bottom: 20px; }
        .breadcrumbs { margin-bottom: 20px; font-size: 18px; }
        .view-toggle { margin-bottom: 20px; }
        .items { display: flex; flex-wrap: wrap; }
        .item { margin: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 200px; text-align: center; }
        .folder { background-color: #f0f0f0; }
        .file { background-color: #fff; }
        .thumbnail { max-width: 180px; max-height: 180px; border: 1px solid #ccc; }
        .actions { margin-top: 5px; }
        .actions a { margin: 0 5px; text-decoration: none; color: blue; }
        .date { font-size: 12px; color: #666; margin: 2px 0; }
        .upload-link { display: inline-block; margin-bottom: 20px; padding: 10px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Raspberry Pi Photo Frame Manager</h1>
        <div class="view-toggle">
            <a href="?view=gallery">View as Gallery</a> | <strong>View as Folders</strong>
        </div>
        <div class="sorting">
            Sort by: 
            <a href="?sort=name" {% if sort_by == 'name' %}style="font-weight: bold;"{% endif %}>Name</a> | 
            <a href="?sort=date" {% if sort_by == 'date' %}style="font-weight: bold;"{% endif %}>Date Modified</a>
        </div>
        <a href="/upload" class="upload-link">Upload Files/Folders</a>
    </div>
    
    <div class="breadcrumbs">
        <a href="/">Root</a>
        {% set path_parts = current_path.split('/') if current_path else [] %}
        {% for i in range(path_parts | length) %}
            {% set part_path = path_parts[0:i+1] | join('/') %}
            / <a href="/{{ part_path }}">{{ path_parts[i] }}</a>
        {% endfor %}
    </div>
    
    <div class="items">
        {% for item in items %}
        <div class="item {{ item.type }}">
            {% if item.type == 'folder' %}
                <div style="font-size: 48px;">üìÅ</div>
                <strong><a href="/{{ item.path }}">{{ item.name }}</a></strong>
                <div class="date">{{ item.date }}</div>
                <div class="actions">
                    <a href="/delete/{{ item.path }}" onclick="return confirm('Delete folder {{ item.name }} and all contents?')">Delete</a>
                </div>
            {% else %}
                <img src="/thumb/{{ item.path }}" alt="{{ item.name }}" class="thumbnail">
                <strong>{{ item.name }}</strong>
                <div class="date">{{ item.date }}</div>
                <div class="actions">
                    <a href="/image/{{ item.path }}" target="_blank">View Full</a>
                    <a href="/delete/{{ item.path }}" onclick="return confirm('Delete {{ item.name }}?')">Delete</a>
                </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</body>
</html>