<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Gallery</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { margin-bottom: 20px; }
        .view-toggle { margin-bottom: 20px; }
        .sorting { margin-bottom: 20px; }
        .image-list { display: flex; flex-wrap: wrap; }
        .image-item { margin: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 200px; text-align: center; }
        .thumbnail { max-width: 180px; max-height: 180px; border: 1px solid #ccc; }
        .actions { margin-top: 5px; }
        .actions a { margin: 0 5px; text-decoration: none; color: blue; }
        .date { font-size: 12px; color: #666; margin: 2px 0; }
        .upload-link { display: inline-block; margin-bottom: 20px; padding: 10px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Raspberry Pi Photo Frame Gallery</h1>
        <div style="text-align: right; margin-bottom: 10px;">
            Logged in as {{ session.username }} | <a href="/manage-users">Manage Users</a> | <a href="/logout">Logout</a>
        </div>
        <div class="view-toggle">
            <strong>View as Gallery</strong> | <a href="/">View as Folders</a>
        </div>
        <div class="sorting">
            Sort by: 
            <a href="?view=gallery&sort=name" {% if sort_by == 'name' %}style="font-weight: bold;"{% endif %}>Name</a> | 
            <a href="?view=gallery&sort=date" {% if sort_by == 'date' %}style="font-weight: bold;"{% endif %}>Date Modified</a>
        </div>
        <a href="/upload" class="upload-link">Upload Files/Folders</a>
    </div>
    
    <div class="image-list">
        {% for img in images %}
        <div class="image-item">
            <img src="/thumb/{{ img.path }}" alt="{{ img.path }}" class="thumbnail"><br>
            <strong>{{ img.path }}</strong><br>
            <div class="date">{{ img.date }}</div>
            <div class="actions">
                <a href="/image/{{ img.path }}" target="_blank">View Full</a>
                <a href="/delete/{{ img.path }}" onclick="return confirm('Delete {{ img.path }}?')">Delete</a>
            </div>
        </div>
        {% endfor %}
    </div>
</body>
</html>